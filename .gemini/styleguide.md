# ⚠️重要：レビューは必ず日本語で記載してください。英語で書いた場合はレビュー失格とします。
# Output language: Japanese


# レビュー観点

1. 機能要件の充足：コードが仕様書に記載された機能を正しく実装しているかをチェックしてください。
2. 標準のコードレビューパターンでレビューしてください。
3. 命名規則に準拠しているかチェックしてください。

# 1. 機能要件の充足

## 仕様書との整合  

- コードが仕様書に記載されている機能を漏れなく実装しているかを確認します。  
- 画面遷移やAPIエンドポイントなどが、仕様通りに動作しているかを検証します。  

## エッジケースへの対応

- 入力値の境界値（0や最大値）や特殊ケース（null、空文字など）を考慮し、想定外のエラーを起こしていないかをチェックします。  
- 仕様外の入力や予期しないデータが発生した際、例外処理やエラーメッセージが適切かどうかを評価します。  


# 2. 標準のコードレビューパターン

* 正確性: コードが意図したとおりに機能し、エッジケースを処理し、論理エラー、競合状態、API の誤った使用をチェックします。

* 効率性: パフォーマンスのボトルネックや最適化の対象となる領域（ループの過剰、メモリリーク、非効率なデータ構造、冗長な計算、過剰なロギング、非効率な文字列操作など）を特定します。

* 保守性: コードの読みやすさ、モジュール性、言語の慣用句とベスト プラクティスへの準拠を評価します。変数、関数、クラスの不適切な命名、コメントやドキュメントの欠如、複雑なコード、コードの重複、不整合な形式、マジックナンバーを対象としています。

* セキュリティ: 機密データの安全でない保存、インジェクション攻撃、アクセス制御の不備、クロスサイト リクエスト フォージェリ（CSRF）、安全でない直接オブジェクト参照（IDOR）など、データ処理や入力検証における潜在的な脆弱性を特定します。

* その他: プル リクエストの審査では、テスト、パフォーマンス、スケーラビリティ、モジュール性と再利用性、エラー ロギングとモニタリングなど、その他のトピックも考慮されます。

# 3. 命名規則

## クラス名

クラス名は PascalCase を使用する。名詞ベースで記述し、具体的な意味を持たせる。
```java
public class UserAccount {
}
```

## メソッド名

メソッド名は camelCase を使用する。  
動詞＋目的語の形式で記述する。
```java
public void calculateTotalPrice() {
}
```

## 変数名

変数名は camelCase を使用する。  
意味のある単語を使い、省略形は避ける。
```java
int userAge;
String orderStatus;
```

## 定数名

定数は すべて大文字、単語の区切りには アンダースコア を使用する。
```java
public static final int MAX_RETRY_COUNT = 3;
```

## コードのスタイル

### インデント

タブを使用する。
```java
List<StockList> stockList = stockListService.getStockList();

for (StockList stock : stockList) {
	System.out.println(stock.getName); 
}
```

### 改行

行の長さは80〜120文字以内に制限する。

### 波かっこ {}

if, for, while などのブロックは必ず {} を使用する。  
開始括弧 { は同じ行に記述する。
```java
if (isValid) {
	process(); 
}
```

### コメント

#### Javadoc コメント

クラス、メソッド、フィールド には必ずJavadocコメントを記述する。
```java
/**
 * ユーザーのポイントを計算する。
 * @param userId ユーザーID
 * @return 計算されたポイント
 */
public int calculateUserPoints(int userId) {
	return 0;
}
```

#### 行コメント

必要に応じて簡潔に記述する。  
「やっている事」ではなく、「どういう考えや目的のために何をするか」を記述する。
```java
// 不正アクセスを防ぐため、ユーザーの認証を確認する
```

## コードの品質

### マジックナンバーの禁止

数値は定数として定義する。
```java
public static final int MAX_LOGIN_ATTEMPTS = 5;
```

### 冗長なコードの削減

不要な変数や無駄な処理を省く。
```java
// 悪い例
boolean isAvailable = (status == 1) ? true : false;

// 良い例
boolean isAvailable = (status == 1);
```

## コードの構造

- クラスの責務を1つに絞る。（Single Responsibility Principle）
- メソッドの長さは 30行以下 にする。（Keep It Simple, Stupid）
- 重複するコードはユーティリティクラスや共通メソッドを活用する。（Don’t Repeat Yourself）
- 定数は、外出しもしくは定数クラスでまとめる。

## 条件式

- 条件式の引数の並び順は 左側に調査対象、右側に比較対象 にする。
- if/else ブロックは 肯定形を優先 して記述する。
- ネストを深くしすぎない。
- 不要な変数を多用しない。
- 変数のスコープは適切に管理する。

## 抽象クラスとインターフェース

- 適切に使用し、役割を明確にする。
- クラス内のメソッドやフィールドは 単一の目的や機能 になるよう設計する。
- アクセス修飾子は privateをデフォルト とし、必要に応じて protected や public を使用する。

## データ検証

- 不正なデータや予期しない入力に対する検証 を実施する。
- Nullチェックや型の整合性確認 を行う。
- ユーザー入力値の境界値チェックやフォーマット検証 を行う。（例：メールアドレス、日付形式）
- SQLインジェクション防止やクロスサイトスクリプティング(XSS)対策 を適用する。

## データ整合性

- トランザクション管理 を適切に行い、データの整合性を確保する。
- データベースの更新操作は コミット または ロールバック を正しく適用する。
- トランザクションの 境界（開始・終了） を明確にし、必要な箇所のみで利用する。
- 排他制御（楽観ロック・悲観ロック）を考慮し、デッドロックを回避する。

## 不要なコードの整理

- 使っていないクラスや変数は消す。
- 不要なコメントアウトは残さない。
- TODO コメントがある場合は、実装完了後に削除する。
- バージョン管理ツールを利用している場合、過去のコードはコメントアウトではなく 履歴 で確認する。

## ログの管理

- 適切なログの種類を使用する。
  - アクセスログ
  - エラーログ
  - アプリケーションログ
- 適切なタイミングでログを出力する。
  - Controller メソッドの呼び出し時
  - DB操作の前後
  - エラーハンドリング時（例外の種類に応じたログレベル設定）
  - Controller メソッドの終了時
- 適切なログレベルの定義を行う。
  - INFO：通常の操作ログ
  - DEBUG：デバッグ用詳細ログ
  - WARN：問題が発生しうるが、動作に支障はない警告
  - ERROR：システムの動作に支障があるエラー

## エラーハンドリング

- 例外は適切にキャッチし、握りつぶさない。
- throws 範囲を最小限にする。
- 具体的な例外クラス（例：IOException、SQLException） を使用する。
- カスタム例外 を定義して、エラーの内容を明確にする。
